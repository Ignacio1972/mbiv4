<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBI Dashboard - Custom Layout</title>
    <link rel="stylesheet" href="../css/mbi-corporate-dark.css">
    <link rel="stylesheet" href="../css/palettes/palette-custom.css">
    
    <style>
        /* Grid principal de 3 filas separadas */
        .dashboard-grid {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    gap: var(--space-lg);
    margin-top: var(--space-xl);
}

/* Cada fila ocupa todo el ancho */
.create-message,
.controls-section,
.recent-messages {
    grid-column: 1;
}

/* Contenedor para controles y chart JUNTOS */
.controls-chart-container {
    display: flex;
    gap: var(--space-xl);
    padding: var(--space-lg);
    align-items: flex-start;
}

/* Controles ocupan m√°s espacio */
.controls-area {
    flex: 2;
}

/* Chart alineado a la derecha */
.chart-area {
    flex: 1;
    min-width: 200px;
    padding: var(--space-lg);
    background: var(--bg-tertiary);
    border-radius: var(--radius-lg);
    text-align: center;
}
        
        .recent-messages {
            grid-column: 1;
            grid-row: 3;  /* Fila 3 para mensajes */
        }

        .controls-section {
            grid-row: 2;  /* Fila 2 para controles */
        }

        .create-message {
            grid-row: 1;  /* Fila 1 para generador */
        }
        
        .message-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-md);
            max-height: 400px;
            overflow-y: auto;
        }
        
        /* Ajustes para hacer los controles m√°s compactos */
        .controls-grid {
            grid-template-columns: 1fr;
            gap: var(--space-lg);
        }
        
        /* Hacer el formulario m√°s limpio */
        .message-form {
            gap: var(--space-lg);
        }
        
        .form-actions {
            justify-content: center;
            border-top: none;
            padding-top: 0;
        }
        
        .btn-primary {
            padding: var(--space-md) var(--space-2xl);
            font-size: 1rem;
        }
        
        /* Hover personalizado para botones de acci√≥n */
        .btn-save:hover {
            background: #10b981 !important;
            color: white !important;
            border-color: #10b981 !important;
        }

        .btn-delete:hover {
            background: #dc2626 !important;
            color: white !important;
            border-color: #dc2626 !important;
        }

        /* Opcional: transici√≥n m√°s suave */
        .btn-save, .btn-delete {
            transition: all 0.2s ease;
        }

        .control-value {
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--text-primary);
            background: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
        }

        /* Dropdown de categor√≠as */
        .category-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            z-index: 100;
            min-width: 140px;
            margin-top: var(--space-xs);
            display: none;
        }

        .category-dropdown.active {
            display: block;
        }

        .category-option {
            padding: var(--space-sm) var(--space-md);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid var(--border-color);
        }

        .category-option:last-child {
            border-bottom: none;
        }

        .category-option:hover {
            background: var(--bg-tertiary);
        }

        .message-badge {
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        /* Toggle */
        .toggle-controls-container {
            padding: var(--space-md);
            text-align: right;
            /* Sin border-top ni background - completamente limpio */
        }

        .btn-toggle-controls {
            background: transparent;
            border: 1px dashed var(--border-color);
            padding: var(--space-sm) var(--space-lg);
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all 0.2s;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .btn-toggle-controls:hover {
            background: var(--bg-tertiary);
            border-style: solid;
            color: var(--text-primary);
        }

        /* Colores por categor√≠a */
        .badge-ofertas { background: #10b981; color: white; }
        .badge-eventos { background: #8b5cf6; color: white; }
        .badge-informacion { background: #0891b2; color: white; }
        .badge-servicios { background: #f59e0b; color: white; }
        .badge-horarios { background: #6366f1; color: white; }
        .badge-emergencias { background: #dc2626; color: white; }
        .badge-sin-categoria { background: var(--gray-500); color: white; }

        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }
            
            .voice-controls {
                grid-column: 1;
                grid-row: 1;
            }
            
            .create-message {
                grid-column: 1;
                grid-row: 2;
            }
            
            .recent-messages {
                grid-column: 1;
                grid-row: 3;
            }
            
            .message-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">MBI</div>
                <div class="logo-text">
                    <div class="logo-title">Mall Barrio Independencia</div>
                    <div class="logo-subtitle">Sistema de Anuncios TTS</div>
                </div>
            </div>
            <nav class="header-nav">
                <a href="#" class="nav-link active">Generador</a>
                <a href="#" class="nav-link">Biblioteca</a>
                <a href="#" class="nav-link">Calendario</a>
                <a href="#" class="nav-link">Radio</a>
                <a href="#" class="nav-link">Reportes</a>
            </nav>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            
            <!-- FILA 1: Generador de Texto -->
            <div class="card create-message">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-icon">üéôÔ∏è</span>
                        Generador de Mensajes
                    </h2>
                </div>
                <form class="message-form">
                    <div class="form-group">
                        <textarea class="form-textarea" 
                                  placeholder="Escriba aqu√≠ el mensaje que ser√° convertido a voz..."
                                  rows="6"></textarea>
                    </div>
                    <div class="form-group">
                        <select class="form-select">
                            <option>Juan Carlos</option>
                            <option>Test Voice</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-primary">
                            <span>üéôÔ∏è</span>
                            Generar Audio
                        </button>
                    </div>
                </form>
                
                <!-- TOGGLE AL FINAL DEL CARD -->
                <div class="toggle-controls-container">
                    <button class="btn-toggle-controls" id="toggleControls">
                        <span>‚öôÔ∏è Controles Avanzados ‚ñ≤</span>
                    </button>
                </div>
            </div>
            
            <!-- FILA 2: Card √∫nico con Controles + Pie Chart juntos -->
            <div class="controls-section" id="controlsSection" style="display: none;">
                <div class="card controls-with-chart">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-icon">üéõÔ∏è</span>
                            Controles de Voz y Consumo
                        </h2>
                    </div>
                    
                    <!-- Contenedor flex para controles y chart lado a lado -->
                    <div class="controls-chart-container">
                        
                        <!-- LADO IZQUIERDO: Controles -->
                        <div class="controls-area">
                            <div class="controls-grid">
                                <div class="control-item">
                                    <label class="control-label">
                                        Estilo
                                        <span class="control-value">50%</span>
                                    </label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" min="0" max="100" value="50" id="style-slider">
                                        <div class="slider-track" style="width: 50%"></div>
                                    </div>
                                </div>
                                <div class="control-item">
                                    <label class="control-label">
                                        Estabilidad
                                        <span class="control-value">75%</span>
                                    </label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" min="0" max="100" value="75" id="stability-slider">
                                        <div class="slider-track" style="width: 75%"></div>
                                    </div>
                                </div>
                                <div class="control-item">
                                    <label class="control-label">
                                        Claridad
                                        <span class="control-value">80%</span>
                                    </label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" min="0" max="100" value="80" id="clarity-slider">
                                        <div class="slider-track" style="width: 80%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="voice-presets">
                                <button class="preset-btn">Neutral</button>
                                <button class="preset-btn active">Amigable</button>
                                <button class="preset-btn">Formal</button>
                                <button class="preset-btn">Urgente</button>
                                <button class="preset-btn">Alegre</button>
                                <button class="preset-btn">Serio</button>
                            </div>
                        </div>
                        
                        <!-- LADO DERECHO: Pie Chart -->
                        <div class="chart-area">
                            <h4 style="font-size: 0.875rem; margin-bottom: 1rem; color: var(--text-primary);">Consumo de Tokens</h4>
                            
                            <!-- Chart SVG -->
                            <div style="position: relative; width: 120px; height: 120px; margin: 0 auto;">
                                <svg width="120" height="120" viewBox="0 0 42 42">
                                    <circle cx="21" cy="21" r="15.915" 
                                            fill="transparent" 
                                            stroke="#e5e7eb" 
                                            stroke-width="3"></circle>
                                    <circle cx="21" cy="21" r="15.915" 
                                            fill="transparent" 
                                            stroke="#6366f1" 
                                            stroke-width="3" 
                                            stroke-dasharray="45 100"
                                            stroke-linecap="round"
                                            style="transform: rotate(-90deg); transform-origin: center;"></circle>
                                </svg>
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--text-primary);">45%</div>
                                    <div style="font-size: 0.75rem; opacity: 0.7; color: var(--text-secondary);">usado</div>
                                </div>
                            </div>
                            
                            <!-- Stats debajo del chart -->
                            <div style="margin-top: 1rem; font-size: 0.75rem; color: var(--text-secondary);">
                                <div style="margin-bottom: 0.25rem;">‚úì Usado: <span style="color: var(--text-primary); font-weight: 600;">45.3K</span> tokens</div>
                                <div style="margin-bottom: 0.5rem;">‚óã Libre: <span style="color: var(--text-primary); font-weight: 600;">54.7K</span> tokens</div>
                                <div style="opacity: 0.7; border-top: 1px solid var(--border-color); padding-top: 0.5rem;">Renueva en 7 d√≠as</div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>


            <!-- FILA 3: Mensajes Recientes -->
            <div class="card recent-messages">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-icon">üìù</span>
                        Mensajes Recientes
                    </h2>
                    <button class="btn-icon">üîÑ</button>
                </div>
                <div class="message-list">
                    <div class="message-item">
                        <div class="message-header">
                            <span class="message-title">Oferta Black Friday</span>
                            <span class="message-badge badge-ofertas">Ofertas</span>
                        </div>
                        <div class="message-preview">
                            Atenci√≥n visitantes, este viernes tenemos incre√≠bles descuentos de hasta 50% en todas las tiendas participantes...
                        </div>
                        <div class="message-footer">
                            <span class="message-time">Hace 5 minutos</span>
                            <div class="message-actions">
                                <button class="btn-icon" title="Reproducir">‚ñ∂</button>
                                <button class="btn-icon btn-save" title="Guardar">‚úì</button>
                                <button class="btn-icon btn-delete" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <div class="message-item">
                        <div class="message-header">
                            <span class="message-title">Cambio de Horario</span>
                            <span class="message-badge badge-info">Info</span>
                        </div>
                        <div class="message-preview">
                            Informamos a nuestros visitantes que a partir del pr√≥ximo lunes el mall abrir√° a las 10:00 AM...
                        </div>
                        <div class="message-footer">
                            <span class="message-time">Hace 1 hora</span>
                            <div class="message-actions">
                                <button class="btn-icon" title="Reproducir">‚ñ∂</button>
                                <button class="btn-icon btn-save" title="Guardar">‚úì</button>
                                <button class="btn-icon btn-delete" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <div class="message-item">
                        <div class="message-header">
                            <span class="message-title">Evacuaci√≥n Simulacro</span>
                            <span class="message-badge badge-urgente">Urgente</span>
                        </div>
                        <div class="message-preview">
                            Atenci√≥n, en 15 minutos realizaremos un simulacro de evacuaci√≥n. Por favor sigan las instrucciones...
                        </div>
                        <div class="message-footer">
                            <span class="message-time">Hace 2 horas</span>
                            <div class="message-actions">
                                <button class="btn-icon" title="Reproducir">‚ñ∂</button>
                                <button class="btn-icon btn-save" title="Guardar">‚úì</button>
                                <button class="btn-icon btn-delete" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <div class="message-item">
                        <div class="message-header">
                            <span class="message-title">Evento Musical</span>
                            <span class="message-badge badge-info">Evento</span>
                        </div>
                        <div class="message-preview">
                            Este s√°bado a las 6 PM presentamos m√∫sica en vivo en la plaza central con la banda local...
                        </div>
                        <div class="message-footer">
                            <span class="message-time">Hace 3 horas</span>
                            <div class="message-actions">
                                <button class="btn-icon" title="Reproducir">‚ñ∂</button>
                                <button class="btn-icon btn-save" title="Guardar">‚úì</button>
                                <button class="btn-icon btn-delete" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <div class="message-item">
                        <div class="message-header">
                            <span class="message-title">Estacionamiento Gratuito</span>
                            <span class="message-badge badge-ofertas">Ofertas</span>
                        </div>
                        <div class="message-preview">
                            Hoy jueves disfrute de estacionamiento gratuito las primeras 3 horas en todos nuestros niveles...
                        </div>
                        <div class="message-footer">
                            <span class="message-time">Hace 4 horas</span>
                            <div class="message-actions">
                                <button class="btn-icon" title="Reproducir">‚ñ∂</button>
                                <button class="btn-icon btn-save" title="Guardar">‚úì</button>
                                <button class="btn-icon btn-delete" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <div class="message-item">
                        <div class="message-header">
                            <span class="message-title">WiFi Gratuito</span>
                            <span class="message-badge badge-info">Info</span>
                        </div>
                        <div class="message-preview">
                            Con√©ctate a nuestra red WiFi gratuita. Red: Mall_Guest, sin contrase√±a requerida...
                        </div>
                        <div class="message-footer">
                            <span class="message-time">Hace 6 horas</span>
                            <div class="message-actions">
                                <button class="btn-icon" title="Reproducir">‚ñ∂</button>
                                <button class="btn-icon btn-save" title="Guardar">‚úì</button>
                                <button class="btn-icon btn-delete" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>

        // Sliders functionality
        const sliders = [
            { id: 'style-slider', unit: '%' },
            { id: 'stability-slider', unit: '%' },
            { id: 'clarity-slider', unit: '%' }
        ];

        sliders.forEach(slider => {
            const element = document.getElementById(slider.id);
            if (element) {
                const track = element.nextElementSibling;
                const valueDisplay = element.parentElement.previousElementSibling.querySelector('.control-value');
                
                element.addEventListener('input', function() {
                    const value = this.value;
                    const max = this.max;
                    const percentage = (value / max) * 100;
                    
                    track.style.width = percentage + '%';
                    valueDisplay.textContent = value + slider.unit;
                });
            }
        });

        // Preset buttons
        const presetButtons = document.querySelectorAll('.preset-btn');
        presetButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                presetButtons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const presets = {
                    'Neutral': [50, 75, 80],
                    'Amigable': [60, 70, 85],
                    'Formal': [30, 85, 90],
                    'Urgente': [70, 90, 95],
                    'Alegre': [80, 65, 85],
                    'Serio': [20, 90, 85]
                };
                
                const presetName = this.textContent;
                if (presets[presetName]) {
                    const values = presets[presetName];
                    ['style-slider', 'stability-slider', 'clarity-slider'].forEach((id, index) => {
                        const slider = document.getElementById(id);
                        if (slider) {
                            slider.value = values[index];
                            slider.dispatchEvent(new Event('input'));
                        }
                    });
                }
            });
        });

        // Message actions - solo reproducir
        document.querySelectorAll('.btn-icon').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Animaci√≥n de click para botones generales
                if (!this.classList.contains('btn-save') && !this.classList.contains('btn-delete')) {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 100);
                }
                
                // Acci√≥n solo para reproducir
                const action = this.title;
                if (action === 'Reproducir') {
                    // Cambiar icono a pausa si est√° reproduciendo
                    this.textContent = this.textContent === '‚ñ∂' ? '‚è∏' : '‚ñ∂';
                }
            });
        });

        // Guardar con confirmaci√≥n
        document.querySelectorAll('.btn-save').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Obtener t√≠tulo del mensaje
                const messageTitle = this.closest('.message-item').querySelector('.message-title').textContent;
                
                // Mostrar confirmaci√≥n personalizada
                if (confirm(`¬°Buena elecci√≥n! ¬øQuieres guardar "${messageTitle}"?`)) {
                    // Cambiar a check verde y animar
                    this.style.color = '#10b981';
                    this.style.background = 'rgba(16, 185, 129, 0.1)';
                    this.style.transform = 'scale(1.2)';
                    this.textContent = '‚úì';
                    
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                    
                    // Feedback adicional
                    const originalTitle = this.title;
                    this.title = 'Guardado';
                    
                    // Opcional: mostrar mensaje temporal
                    const messageItem = this.closest('.message-item');
                    messageItem.style.borderColor = '#10b981';
                    setTimeout(() => {
                        messageItem.style.borderColor = '';
                    }, 2000);
                }
            });
        });

        // Eliminar
        document.querySelectorAll('.btn-delete').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Confirmar eliminaci√≥n
                if (confirm('¬øEliminar este mensaje?')) {
                    const messageItem = this.closest('.message-item');
                    messageItem.style.opacity = '0';
                    messageItem.style.transform = 'translateX(-20px)';
                    setTimeout(() => {
                        messageItem.remove();
                    }, 300);
                }
            });
        });

        // Message items click - cargar texto en textarea
        document.querySelectorAll('.message-item').forEach(item => {
            item.addEventListener('click', function() {
                // Highlight selected
                document.querySelectorAll('.message-item').forEach(i => {
                    i.style.borderColor = 'var(--border-color)';
                });
                this.style.borderColor = 'var(--primary)';
                
                // Cargar el texto en el textarea
                const messageText = this.querySelector('.message-preview').textContent.trim();
                const textarea = document.querySelector('.form-textarea');
                if (textarea) {
                    textarea.value = messageText;
                    textarea.dispatchEvent(new Event('input'));
                }
            });
        });

        // Nav links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Refresh button
        const refreshBtn = document.querySelector('.recent-messages .btn-icon');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', function() {
                this.style.transform = 'rotate(360deg)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 500);
            });
        }

        // Sistema de cambio de categor√≠as
        document.querySelectorAll('.message-badge').forEach(badge => {
            // Crear dropdown para cada badge
            const dropdown = document.createElement('div');
            dropdown.className = 'category-dropdown';
            dropdown.innerHTML = `
                <div class="category-option" data-category="ofertas">‚úÖ Ofertas</div>
                <div class="category-option" data-category="eventos">üéâ Eventos</div>
                <div class="category-option" data-category="informacion">‚ÑπÔ∏è Informaci√≥n</div>
                <div class="category-option" data-category="servicios">üõ†Ô∏è Servicios</div>
                <div class="category-option" data-category="horarios">üïê Horarios</div>
                <div class="category-option" data-category="emergencias">üö® Emergencias</div>
                <div class="category-option" data-category="sin-categoria">üìã Sin Categor√≠a</div>
            `;
            
            // Envolver badge en contenedor con dropdown
            const wrapper = document.createElement('div');
            wrapper.style.position = 'relative';
            badge.parentNode.insertBefore(wrapper, badge);
            wrapper.appendChild(badge);
            wrapper.appendChild(dropdown);
            
            // Click en badge abre dropdown
            badge.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Cerrar otros dropdowns
                document.querySelectorAll('.category-dropdown').forEach(d => {
                    if (d !== dropdown) d.classList.remove('active');
                });
                
                // Toggle este dropdown
                dropdown.classList.toggle('active');
            });
            
            // Click en opci√≥n cambia categor√≠a
            dropdown.querySelectorAll('.category-option').forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    const newCategory = this.dataset.category;
                    const categoryLabels = {
                        'ofertas': 'Ofertas',
                        'eventos': 'Eventos',
                        'informacion': 'Info',
                        'servicios': 'Servicios',
                        'horarios': 'Horarios',
                        'emergencias': 'Urgente',
                        'sin-categoria': 'Sin Cat.'
                    };
                    
                    // Actualizar badge
                    badge.textContent = categoryLabels[newCategory];
                    badge.className = `message-badge badge-${newCategory}`;
                    badge.dataset.category = newCategory;
                    
                    // Cerrar dropdown
                    dropdown.classList.remove('active');
                    
                    // Animaci√≥n de confirmaci√≥n
                    badge.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        badge.style.transform = 'scale(1)';
                    }, 200);
                });
            });
        });

        // Cerrar dropdowns al hacer click fuera
        document.addEventListener('click', function() {
            document.querySelectorAll('.category-dropdown').forEach(d => {
                d.classList.remove('active');
            });
        });

        // Toggle simple
        const toggleBtn = document.getElementById('toggleControls');
        const controlsSection = document.getElementById('controlsSection');
        let visible = false;

        toggleBtn.addEventListener('click', function() {
            visible = !visible;
            
            if (visible) {
                controlsSection.style.display = 'block';
                this.innerHTML = '<span>‚öôÔ∏è Controles Avanzados ‚ñº</span>';  // Flecha abajo cuando est√° abierto
            } else {
                controlsSection.style.display = 'none';
                this.innerHTML = '<span>‚öôÔ∏è Controles Avanzados ‚ñ≤</span>';  // Flecha arriba cuando est√° cerrado
            }
            
            localStorage.setItem('controlsVisible', visible);
        });

        // Cargar preferencia
        const saved = localStorage.getItem('controlsVisible');
        if (saved === 'true') {
            visible = true;
            controlsSection.style.display = 'block';
            toggleBtn.innerHTML = '<span>‚öôÔ∏è Controles Avanzados ‚ñº</span>';  // Flecha abajo si empieza abierto
        }

        // Generar t√≠tulos autom√°ticos desde el contenido
        document.querySelectorAll('.message-item').forEach(item => {
            const preview = item.querySelector('.message-preview').textContent.trim();
            const titleElement = item.querySelector('.message-title');
            
            // Tomar las primeras 4 palabras
            const words = preview.split(' ').slice(0, 4);
            const autoTitle = words.join(' ');
            
            // Si el mensaje tiene m√°s de 4 palabras, agregar "..."
            const fullWords = preview.split(' ');
            if (fullWords.length > 4) {
                titleElement.textContent = autoTitle + '...';
            } else {
                titleElement.textContent = autoTitle;
            }
        });
    </script>
</body>
</html>