<style>
    @import url('/new-design/css/mbi-corporate-dark.css');
    @import url('/new-design/css/palettes/palette-custom.css');
    @import url('/modules/dashboard-v2/styles/dashboard.css');
</style>

<!-- Dashboard Grid -->
<div class="dashboard-grid">
    
    <!-- FILA 1: Generador de Texto -->
    <div class="card create-message">
        <div class="card-header">
            <h2 class="card-title">
                <span class="card-icon">ğŸ™ï¸</span>
                Generador de Mensajes Buenos
            </h2>
        </div>
        <form class="message-form" id="messageForm">
            <div class="form-group">
                <textarea 
                    id="messageText"
                    class="form-textarea" 
                    placeholder="Escriba aquÃ­ el mensaje que serÃ¡ convertido a voz..."
                    rows="6"></textarea>
            </div>
            <div class="form-group">
                <select id="voiceSelect" class="form-select">
                    <!-- Se llenarÃ¡ dinÃ¡micamente -->
                </select>
            </div>
            <!-- AGREGAR DESPUÃ‰S DE LÃNEA 29 -->
<div class="form-group">
    <label class="form-label" for="categorySelect">CategorÃ­a del mensaje</label>
    <select id="categorySelect" class="form-select">
        <option value="sin_categoria">ğŸ“‹ Sin categorÃ­a</option>
        <option value="ofertas">ğŸ·ï¸ Ofertas</option>
        <option value="eventos">ğŸ‰ Eventos</option>
        <option value="informacion">â„¹ï¸ InformaciÃ³n</option>
        <option value="servicios">ğŸ› ï¸ Servicios</option>
        <option value="horarios">ğŸ• Horarios</option>
        <option value="emergencias">ğŸš¨ Emergencias</option>
    </select>
</div>
            <div class="form-actions">
                <button type="button" id="generateBtn" class="btn btn-primary">
                    <span>ğŸ™ï¸</span>
                    Generar Audio
                </button>
            </div>
        </form>
        
        <!-- TOGGLE AL FINAL DEL CARD -->
        <div class="toggle-controls-container">
            <button class="btn-toggle-controls" id="toggleControls">
                <span>âš™ï¸ Controles Avanzados â–¼</span>
            </button>
        </div>
    </div>
    
    <!-- FILA 2: Card Ãºnico con Controles + Pie Chart juntos -->
    <div class="controls-section" id="controlsSection" style="display: none;">
        <div class="card controls-with-chart">
            <div class="card-header">
                <h2 class="card-title">
                    <span class="card-icon">ğŸ›ï¸</span>
                    Controles de Voz y Consumo
                </h2>
            </div>
            
            <!-- Contenedor flex para controles y chart lado a lado -->
            <div class="controls-chart-container">
                
                <!-- LADO IZQUIERDO: Controles (SIN PRESETS) -->
                <div class="controls-area">
                    <div class="controls-grid">
                        <div class="control-item">
                            <label class="control-label">
                                Estilo
                                <span class="control-value" id="styleValue">50%</span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="0" max="100" value="50" id="styleSlider">
                                <div class="slider-track" id="styleTrack" style="width: 50%"></div>
                            </div>
                        </div>
                        <div class="control-item">
                            <label class="control-label">
                                Estabilidad
                                <span class="control-value" id="stabilityValue">75%</span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="0" max="100" value="75" id="stabilitySlider">
                                <div class="slider-track" id="stabilityTrack" style="width: 75%"></div>
                            </div>
                        </div>
                        <div class="control-item">
                            <label class="control-label">
                                Claridad
                                <span class="control-value" id="clarityValue">80%</span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="0" max="100" value="80" id="claritySlider">
                                <div class="slider-track" id="clarityTrack" style="width: 80%"></div>
                            </div>
                        </div>
                    </div>
                    <!-- ELIMINADOS LOS 6 BOTONES DE PRESETS -->
                </div>
                
                <!-- LADO DERECHO: Pie Chart -->
                <div class="chart-area">
                    <h4 style="font-size: 0.875rem; margin-bottom: 1rem; color: var(--text-primary);">Consumo de Tokens</h4>
                    
                    <!-- Chart SVG -->
                    <div style="position: relative; width: 120px; height: 120px; margin: 0 auto;">
                        <svg width="120" height="120" viewBox="0 0 42 42">
                            <circle cx="21" cy="21" r="15.915" 
                                    fill="transparent" 
                                    stroke="#e5e7eb" 
                                    stroke-width="3"></circle>
                            <circle cx="21" cy="21" r="15.915" 
                                    fill="transparent" 
                                    stroke="#6366f1" 
                                    stroke-width="3" 
                                    stroke-dasharray="45 100"
                                    stroke-linecap="round"
                                    id="quotaProgressCircle"
                                    style="transform: rotate(-90deg); transform-origin: center;"></circle>
                        </svg>
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                            <div id="quotaPercentage" style="font-size: 1.5rem; font-weight: bold; color: var(--text-primary);">0%</div>
                            <div style="font-size: 0.75rem; opacity: 0.7; color: var(--text-secondary);">usado</div>
                        </div>
                    </div>
                    
                    <!-- Stats debajo del chart -->
                    <div style="margin-top: 1rem; font-size: 0.75rem; color: var(--text-secondary);">
                        <div style="margin-bottom: 0.25rem;">âœ“ Usado: <span id="quotaUsed" style="color: var(--text-primary); font-weight: 600;">0</span> tokens</div>
                        <div style="margin-bottom: 0.5rem;">â—‹ Libre: <span id="quotaRemaining" style="color: var(--text-primary); font-weight: 600;">0</span> tokens</div>
                        <div id="quotaResetDate" style="opacity: 0.7; border-top: 1px solid var(--border-color); padding-top: 0.5rem;">Cargando...</div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>

    <!-- FILA 3: Mensajes Recientes -->
    <div class="card recent-messages">
        <div class="card-header">
            <h2 class="card-title">
                <span class="card-icon">ğŸ“</span>
                Mensajes Recientes
            </h2>
            <button class="btn-icon" id="refreshMessages">ğŸ”„</button>
        </div>
        <div class="message-list" id="messageList">
            <!-- Los mensajes se cargarÃ¡n dinÃ¡micamente aquÃ­ -->
            <div class="loading-messages" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                Cargando mensajes...
            </div>
        </div>
    </div>

</div>